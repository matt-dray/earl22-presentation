<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.32">

  <meta name="author" content="Matt Dray, Civil Service">
  <title>{a11ytables}</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">{a11ytables}</h1>
  <p class="subtitle">EARL, September 2022</p>
  <p class="author">Matt Dray, Civil Service</p>
</section>

<section id="tldr" class="slide level2 center">
<h2>tl;dr</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p>Generate best-practice spreadsheets with <a href="https://www.co-analysis.github.io/a11ytables">{a11ytables}</a></p>
<p>Make the world a better place (marginally)</p>
</div><div class="column" style="width:30%;">
<p><img data-src="images/qr_a11ytables-docs.png" alt="QR code that points to the documentation website of the R package 'a11ytables'."></p>
</div>
</div>
<aside class="notes">
<ul>
<li>The package helps bring automation, consistency and reproducibility to usable spreadsheets; it does the hard work for you.</li>
<li>It can make your life easier.</li>
<li>But the talk is also about inclusivity, taking the initiative and fixing things.</li>
<li>Which makes everyone’s lives better.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ahoy" class="slide level2 center">
<h2>Ahoy</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p>I like R for reproducibility</p>
<p>(And for memes)</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.4 151.7c.325 4.548 .325 9.097 .325 13.65 0 138.7-105.6 298.6-298.6 298.6-59.45 0-114.7-17.22-161.1-47.11 8.447 .974 16.57 1.299 25.34 1.299 49.06 0 94.21-16.57 130.3-44.83-46.13-.975-84.79-31.19-98.11-72.77 6.498 .974 12.99 1.624 19.82 1.624 9.421 0 18.84-1.3 27.61-3.573-48.08-9.747-84.14-51.98-84.14-102.1v-1.299c13.97 7.797 30.21 12.67 47.43 13.32-28.26-18.84-46.78-51.01-46.78-87.39 0-19.49 5.197-37.36 14.29-52.95 51.65 63.67 129.3 105.3 216.4 109.8-1.624-7.797-2.599-15.92-2.599-24.04 0-57.83 46.78-104.9 104.9-104.9 30.21 0 57.5 12.67 76.67 33.14 23.72-4.548 46.46-13.32 66.6-25.34-7.798 24.37-24.37 44.83-46.13 57.83 21.12-2.273 41.58-8.122 60.43-16.24-14.29 20.79-32.16 39.31-52.63 54.25z"></path></svg> <a href="https://www.twitter.com/mattdray"><span class="citation" data-cites="mattdray">@mattdray</span></a> <svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M352 256C352 278.2 350.8 299.6 348.7 320H163.3C161.2 299.6 159.1 278.2 159.1 256C159.1 233.8 161.2 212.4 163.3 192H348.7C350.8 212.4 352 233.8 352 256zM503.9 192C509.2 212.5 512 233.9 512 256C512 278.1 509.2 299.5 503.9 320H380.8C382.9 299.4 384 277.1 384 256C384 234 382.9 212.6 380.8 192H503.9zM493.4 160H376.7C366.7 96.14 346.9 42.62 321.4 8.442C399.8 29.09 463.4 85.94 493.4 160zM344.3 160H167.7C173.8 123.6 183.2 91.38 194.7 65.35C205.2 41.74 216.9 24.61 228.2 13.81C239.4 3.178 248.7 0 256 0C263.3 0 272.6 3.178 283.8 13.81C295.1 24.61 306.8 41.74 317.3 65.35C328.8 91.38 338.2 123.6 344.3 160H344.3zM18.61 160C48.59 85.94 112.2 29.09 190.6 8.442C165.1 42.62 145.3 96.14 135.3 160H18.61zM131.2 192C129.1 212.6 127.1 234 127.1 256C127.1 277.1 129.1 299.4 131.2 320H8.065C2.8 299.5 0 278.1 0 256C0 233.9 2.8 212.5 8.065 192H131.2zM194.7 446.6C183.2 420.6 173.8 388.4 167.7 352H344.3C338.2 388.4 328.8 420.6 317.3 446.6C306.8 470.3 295.1 487.4 283.8 498.2C272.6 508.8 263.3 512 255.1 512C248.7 512 239.4 508.8 228.2 498.2C216.9 487.4 205.2 470.3 194.7 446.6H194.7zM190.6 503.6C112.2 482.9 48.59 426.1 18.61 352H135.3C145.3 415.9 165.1 469.4 190.6 503.6V503.6zM321.4 503.6C346.9 469.4 366.7 415.9 376.7 352H493.4C463.4 426.1 399.8 482.9 321.4 503.6V503.6z"></path></svg> <a href="https://www.matt-dray.com">matt-dray.com</a></p>
</div><div class="column" style="width:30%;">
<p><img data-src="images/mattdray-avatar.png" alt="16 by 16 pixel image of the author's face, which has big eyebrows and a goatee."></p>
</div>
</div>
<aside class="notes">
<ul>
<li>I work in UK government and I’m talking about something I made in that official capacity.</li>
<li>I personally can be found elsewhere in an unofficial capacity.</li>
<li>You can <a href="https://www.rostrum.blog/">read blogposts</a> about building an interactive roguelike videogame in R; making a Twitterbot with R and GitHub Actions; trolling about assignment operators; and more.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section>
<section id="an-opportunity" class="title-slide slide level1 center">
<h1>An opportunity</h1>
<aside class="notes">
<ul>
<li>Who has opened an ‘official’ spreadsheet and immediately winced?</li>
<li>Yes, they sometimes hurt my eyes too, but rather than complain, maybe we can see the opportunity.</li>
<li>I’ll show an example of a government spreadsheet that could be improved. It was one of the first ones that came up in my search of GOV.UK statistics.</li>
<li>The intent is to demonstrate opportunity, not to call anyone out. The maintainer of the statistics knows I’m talking about this.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/website_eggs.png">
<h2 data-id="quarto-animate-title"></h2>
<div class="clippy-speech absolute" data-id="speech" style="top: 120%; left: 120%; ">
<p>It looks like you’re trying to improve a spreadsheet.</p>
</div>
<p><img data-src="images/not-clippy.png" class="absolute" style="top: 120%; left: 120%; width: 100px; "></p>
</section>
<section id="section-1" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/website_eggs.png">
<h2 data-id="quarto-animate-title"></h2>
<div class="clippy-speech absolute" data-id="speech" style="top: 10%; left: 45%; ">
<p>It looks like you’re trying to improve a spreadsheet.</p>
</div>
<p><img data-src="images/not-clippy.png" class="absolute" style="top: 30%; left: 65%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Defra’s <a href="https://www.gov.uk/government/statistics/egg-statistics">‘Latest UK egg statistics’</a>.</li>
<li>Mundane? Definitely a classic government spreadsheet.</li>
<li>Collects data on egg production and prices from a survey.</li>
<li>Branded as National Statistics. That’s important.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-2" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_old-eggs-1.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy.png" class="absolute" style="top: 3%; left: 55%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>This is the ‘UK egg packing station throughput and prices dataset’ spreadsheet.</li>
<li>First tab: ‘Packers’.</li>
<li>Being nitpicky, how would this fare for machine readability? Screenreaders?</li>
<li>Look out for:
<ul>
<li>empty rows, columns, cells (including A1)</li>
<li>gridlines sometimes missing, sometimes not</li>
<li>triple headers</li>
<li>centred values (mostly)</li>
<li>the number of decimals varies (though Excel hides this)</li>
<li>there’s some stray values with no explanation</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-3" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_old-eggs-2.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy.png" class="absolute" style="top: 75%; left: 45%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Second tab: ‘Packers_Annual’.</li>
<li>Look out for same as previous tab, plus:
<ul>
<li>notes in a footer, not labelled</li>
<li>two ‘year’ columns?</li>
<li>some rogue values on the far right</li>
<li>shorthand not fully conforming to guidance (‘c’ rather than ‘[c]’?)</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-4" class="slide level2" data-background-image="images/spreadsheet_old-eggs-3.png" data-auto-animate="true" data-auto-animate-easing="ease-in-out">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy.png" class="absolute" style="top: 25%; left: 27%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Third tab: ‘Information’.</li>
<li>Look out for:
<ul>
<li>important information on the last page instead of a cover or explicit annex</li>
<li>information is in text boxes rather than cells</li>
<li>‘updated’ information is in a different place</li>
<li>GOV.UK link way off to the right</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="support" class="title-slide slide level1 center">
<h1>Support</h1>
<aside class="notes">
<ul>
<li>Maybe you can see the things you’d like to fix, maybe some are obvious, maybe some are more subjective.</li>
<li>But there are a thousand reasons why teams can’t just improve things overnight, like lack of staff, lack of time, inertia from pre-existing point-and-click solutions, etc.</li>
<li>However, there is a place to start: some codified and exhaustive guidance on the preferred outcomes.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-5" class="slide level2" data-background-image="images/website_spreadsheet-guidance-af.png">
<h2></h2>
<aside class="notes">
<ul>
<li>The Analysis Function has a webpage with <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/">some bumper advice</a> on releasing data in spreadsheet format. This was coordinated by Hannah Thomas.</li>
<li>This is important role of the newly-formed Analysis Function: unify guidance across the analytical professions.</li>
<li>Promotes consistency and usability, but particularly accessibility.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-6" class="slide level2" data-background-image="images/spreadsheet_empathy-hidden.png">
<h2></h2>
<p><img data-src="images/not-clippy-inverse.png" class="absolute" style="top: 70%; left: 95%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>On accessibility in particular, Hannah wrote <a href="https://analysisfunction.civilservice.gov.uk/blog/accessibility-empathy-for-users-of-spreadsheets/">a great blog</a> about accessibility empathy for spreadsheet users.</li>
<li>Can you find information in a spreadsheet where all the cells are blacked out?</li>
<li>It ’shows you what it is like trying to navigate a data table when you cannot see the layout.</li>
<li>Gives ‘some idea of the issues faced by users with visual impairments.’</li>
<li>Hannah also runs an accessibility clinic for civil servants to chat through concerns or ideas.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-7" class="slide level2" data-background-image="images/website_rap-strategy.png">
<h2></h2>
<aside class="notes">
<ul>
<li>We can help make users’ lives better with better spreadsheets. But there’s also a way to make out lives easier as producers.</li>
<li><a href="https://analysisfunction.civilservice.gov.uk/support/reproducible-analytical-pipelines/">Reproducible Analytical Pipelines (RAP)</a> is a grassroots movement that’s been bubbling around UK government for a few years.</li>
<li>RAPs are ‘automated statistical and analytical processes [that] incorporate elements of software engineering best practice to ensure that the pipelines are reproducible, auditable, efficient, and high quality.’</li>
<li>There’s now <a href="https://analysisfunction.civilservice.gov.uk/policy-store/reproducible-analytical-pipelines-strategy/">a formal strategy for adoption</a> that should empower publishers to improve their outputs.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="building-a-tool" class="title-slide slide level1 center">
<h1>Building a tool</h1>
<aside class="notes">
<ul>
<li>Many teams have applied the advice to their publications</li>
<li>There are still opportunities</li>
<li>How can we make things easier:
<ul>
<li>as part of a RAP?</li>
<li>for entry-level coders?</li>
<li>by taking into account the realities of ‘at the coalface’ production?</li>
<li>by taking the initiative?</li>
<li>to prevent duplication of effort?</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="requirements" class="slide level2 center">
<h2>Requirements</h2>
<ol type="1">
<li>Simple</li>
<li>Opinionated</li>
<li>Compliant</li>
<li>Known</li>
</ol>
<aside class="notes">
<ol type="1">
<li>Simple user-interface/API, internal structure should be understood by devs</li>
<li>Decisions should be taken for you to help speed things up and maintain consistency.</li>
<li>The whole point is to meet the guidance, {a11ytables} accessibility checklist vignette.</li>
<li>Should try to be a generic cross-government, unified solution to prevent duplicated effort (perhaps easier for my department, which is a the centre of government).</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-8" class="slide level2" data-background-image="images/website_a11ytables-docs.png">
<h2></h2>
<aside class="notes">
<ul>
<li><a href="https://co-analysis.github.io/a11ytables/">Documentation</a>.</li>
<li>Bottom-up to solve my own needs, with wider implications.</li>
</ul>
<ol type="1">
<li>Simple: interface has only two main functions; only two dependencies are {openxlsx} and {pillar}; familiarity of dataframes and pipes; user brings data and information, {a11ytables} does the rest.</li>
<li>Opinionated: some flexibly lost, not all spreadsheets are simple, but you can intervene.</li>
<li>Compliant: a vignette compares the package’s functionality to to the accessibility checklist in the guidance.</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-9" class="slide level2" data-background-image="images/website_gptables-docs.png">
<h2></h2>
<aside class="notes">
<ul>
<li><a href="https://gptables.readthedocs.io/en/latest/">Documentation</a></li>
<li>Written for Python, convert pandas dataframes.</li>
<li>{a11ytables} was created to comply with the <em>latest</em> best practice guidance for releasing stats in spreadsheets, which gptables did not do at the time.</li>
<li>Can be accessed from R via the {reticulate} package, but requires a Python installation and understanding of {reticulate}.</li>
<li>Slight differences between {a11ytables} and gptables exist, hopefully will clear these up.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="how" class="title-slide slide level1 center">
<h1>How</h1>

</section>
<section id="install" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Install</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb1-1" class="hljs-ln-code"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-2" class="hljs-ln-code"><a href="#cb1-2"></a></span>
<span id="cb1-3" class="hljs-ln-code"><a href="#cb1-3"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(</span>
<span id="cb1-4" class="hljs-ln-code"><a href="#cb1-4"></a>  <span class="st">"co-analysis/a11ytables"</span>,</span>
<span id="cb1-5" class="hljs-ln-code"><a href="#cb1-5"></a>  <span class="at">build_vignettes =</span> <span class="cn">TRUE</span></span>
<span id="cb1-6" class="hljs-ln-code"><a href="#cb1-6"></a>)</span>
<span id="cb1-7" class="hljs-ln-code"><a href="#cb1-7"></a></span>
<span id="cb1-8" class="hljs-ln-code"><a href="#cb1-8"></a><span class="fu">library</span>(a11ytables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>GitHub only for now.</li>
<li>Is this a barrier in some orgs?</li>
<li>Still in development, but it has reached version 0.1.</li>
<li>CRAN is a future goal, maybe.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="overview" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Overview</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb2-1" class="hljs-ln-code"><a href="#cb2-1"></a><span class="fu">create_a11ytable</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-2" class="hljs-ln-code"><a href="#cb2-2"></a>  <span class="fu">generate_workbook</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-3" class="hljs-ln-code"><a href="#cb2-3"></a>  openxlsx<span class="sc">::</span><span class="fu">saveWorkbook</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ol type="1">
<li>Organise all the required information into a special dataframe with additional class ‘a11ytable’</li>
<li>Convert to {openxlsx} ‘Workbook’ class with structure and style information</li>
<li>Write that object to an xlsx file</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="overview-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Overview</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb3-1" class="hljs-ln-code"><a href="#cb3-1"></a><span class="fu">create_a11ytable</span>(</span>
<span id="cb3-2" class="hljs-ln-code"><a href="#cb3-2"></a>  tab_titles, sheet_types, sheet_titles, <span class="co"># required char vectors</span></span>
<span id="cb3-3" class="hljs-ln-code"><a href="#cb3-3"></a>  blank_cells, sources,                  <span class="co"># optional char vectors</span></span>
<span id="cb3-4" class="hljs-ln-code"><a href="#cb3-4"></a>  tables                                 <span class="co"># required listcol of dataframes</span></span>
<span id="cb3-5" class="hljs-ln-code"><a href="#cb3-5"></a>) <span class="sc">|&gt;</span></span>
<span id="cb3-6" class="hljs-ln-code"><a href="#cb3-6"></a>  <span class="fu">generate_workbook</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-7" class="hljs-ln-code"><a href="#cb3-7"></a>  openxlsx<span class="sc">::</span><span class="fu">saveWorkbook</span>(<span class="st">"file.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>The <code>create_a11ytable()</code> function takes a few arguments:
<ul>
<li><code>tab_titles</code> is a required character vector for the text that goes on the tabs</li>
<li><code>sheet_types</code> is a required character vector (one of <code>"cover"</code>, <code>"contents"</code>, <code>"notes"</code>, <code>"tables"</code>) that provides information about how the sheet will be styled</li>
<li><code>sheet_titles</code> is a required character vector of the worksheet titles that will go in cell A1</li>
<li><code>blank_cells</code> optional character vector of meta-information that explains the meaning of any blank cells in the sheet</li>
<li><code>sources</code> is an optional character vector of meta-information that contains</li>
<li><code>tables</code> is a required list-column of dataframes that contain the main bulk of each sheet (stats tables are obviously tables, but the cover and notes are also given as tables; you also provide the cover as a dataframe, where each row becomes a subsection with a title and body)</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="prep" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Prep</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb4-1" class="hljs-ln-code"><a href="#cb4-1"></a><span class="fu">source</span>(<span class="st">"eggs/eggs.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>I pre-wrote some code to extract data from the eggs spreadsheet.</li>
<li>You can find the code and original spreadsheet in <a href="https://www.github.com/matt-dray/earl22-presentation">the repo that hosts these slides</a>.</li>
<li>Importantly, I didn’t mimic the whole process of production for this example; I just copied the data out of the pre-existing spreadsheet.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="prep-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Prep</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb5-1" class="hljs-ln-code"><a href="#cb5-1"></a><span class="fu">source</span>(<span class="st">"eggs/eggs.R"</span>)</span>
<span id="cb5-2" class="hljs-ln-code"><a href="#cb5-2"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "egg_blank_cells"  "egg_sheet_titles" "egg_sheet_types"  "egg_sources"     
[5] "egg_tab_titles"   "egg_tables"      </code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>The code outputs some objects that are ready to be passed to the arguments of <code>create_a11ytable()</code>.</li>
<li>I recommend generating each object outside of the call to <code>create_a11ytable()</code> where possible; it keeps things cleaner.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="prep-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Prep</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">source</span>(<span class="st">"eggs/eggs.R"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">ls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "egg_blank_cells"  "egg_sheet_titles" "egg_sheet_types"  "egg_sources"     
[5] "egg_tab_titles"   "egg_tables"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>egg_sheet_titles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "UK egg packing station throughput and prices"         
[2] "Contents"                                             
[3] "Notes"                                                
[4] "Table 1: Throughput by country, quarterly"            
[5] "Table 2: Throughput by system, quarterly"             
[6] "Table 3: Average packer to producer prices, quarterly"
[7] "Table 4: Throughput by country, annual"               
[8] "Table 5: Throughput by system, annual"                
[9] "Table 6: Average packer to producer prices, annual"   </code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>Here’s <code>the sheet_titles</code> object, which is a required character vector that contains the titles of each worksheet, for example.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="create" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Create</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb11-1" class="hljs-ln-code"><a href="#cb11-1"></a>egg_at <span class="ot">&lt;-</span> <span class="fu">create_a11ytable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>Now we can pass our egg objects to the arguments of <code>create_a11ytable()</code>.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="create-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Create</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb12-1" class="hljs-ln-code"><a href="#cb12-1"></a>egg_at <span class="ot">&lt;-</span> <span class="fu">create_a11ytable</span>(</span>
<span id="cb12-2" class="hljs-ln-code"><a href="#cb12-2"></a>  <span class="at">tab_titles   =</span> egg_tab_titles, </span>
<span id="cb12-3" class="hljs-ln-code"><a href="#cb12-3"></a>  <span class="at">sheet_types  =</span> egg_sheet_types, </span>
<span id="cb12-4" class="hljs-ln-code"><a href="#cb12-4"></a>  <span class="at">sheet_titles =</span> egg_sheet_titles,</span>
<span id="cb12-5" class="hljs-ln-code"><a href="#cb12-5"></a>  <span class="at">blank_cells  =</span> egg_blank_cells, </span>
<span id="cb12-6" class="hljs-ln-code"><a href="#cb12-6"></a>  <span class="at">sources      =</span> egg_sources,</span>
<span id="cb12-7" class="hljs-ln-code"><a href="#cb12-7"></a>  <span class="at">tables       =</span> egg_tables</span>
<span id="cb12-8" class="hljs-ln-code"><a href="#cb12-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>Basically, each arg becomes a column in a dataframe.</li>
<li>User is warned and/or errors raised and/or corrections applied if the provided information is insufficient.</li>
<li>User provides the info, function does the rest.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="create-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Create</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb13-1" class="hljs-ln-code"><a href="#cb13-1"></a>egg_at <span class="ot">&lt;-</span> <span class="fu">create_a11ytable</span>(</span>
<span id="cb13-2" class="hljs-ln-code"><a href="#cb13-2"></a>  <span class="at">tab_titles   =</span> egg_tab_titles, </span>
<span id="cb13-3" class="hljs-ln-code"><a href="#cb13-3"></a>  <span class="at">sheet_types  =</span> egg_sheet_types, </span>
<span id="cb13-4" class="hljs-ln-code"><a href="#cb13-4"></a>  <span class="at">sheet_titles =</span> egg_sheet_titles,</span>
<span id="cb13-5" class="hljs-ln-code"><a href="#cb13-5"></a>  <span class="at">blank_cells  =</span> egg_blank_cells, </span>
<span id="cb13-6" class="hljs-ln-code"><a href="#cb13-6"></a>  <span class="at">sources      =</span> egg_sources,</span>
<span id="cb13-7" class="hljs-ln-code"><a href="#cb13-7"></a>  <span class="at">tables       =</span> egg_tables</span>
<span id="cb13-8" class="hljs-ln-code"><a href="#cb13-8"></a>)</span>
<span id="cb13-9" class="hljs-ln-code"><a href="#cb13-9"></a></span>
<span id="cb13-10" class="hljs-ln-code"><a href="#cb13-10"></a><span class="fu">class</span>(egg_at)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a11ytable"  "tbl"        "data.frame"</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>You can see that the object gets the special ‘a11ytables’ S3 class, which helps with validation.</li>
<li>But it also has classes of ‘tbl’ (i.e.&nbsp;a {tibble} dataframe) and classic ‘data.frame’.</li>
<li>This means you can manipulate the output much like any dataframe object.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-dataframe" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A dataframe?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb15-1" class="hljs-ln-code"><a href="#cb15-1"></a>egg_at</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># a11ytable: 9 x 6
  tab_title sheet_type sheet_title                       blank…¹ source table   
  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;                             &lt;chr&gt;   &lt;chr&gt;  &lt;named &gt;
1 Cover     cover      UK egg packing station throughpu… &lt;NA&gt;    &lt;NA&gt;   &lt;df&gt;    
2 Contents  contents   Contents                          &lt;NA&gt;    &lt;NA&gt;   &lt;df&gt;    
3 Notes     notes      Notes                             &lt;NA&gt;    &lt;NA&gt;   &lt;df&gt;    
4 Table_1   tables     Table 1: Throughput by country, … &lt;NA&gt;    Quart… &lt;tibble&gt;
5 Table_2   tables     Table 2: Throughput by system, q… &lt;NA&gt;    Quart… &lt;tibble&gt;
6 Table_3   tables     Table 3: Average packer to produ… &lt;NA&gt;    Quart… &lt;tibble&gt;
7 Table_4   tables     Table 4: Throughput by country, … &lt;NA&gt;    Quart… &lt;tibble&gt;
8 Table_5   tables     Table 5: Throughput by system, a… &lt;NA&gt;    Quart… &lt;tibble&gt;
9 Table_6   tables     Table 6: Average packer to produ… &lt;NA&gt;    Quart… &lt;tibble&gt;
# … with abbreviated variable name ¹​blank_cells</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>Familiar dataframe structure holds all the information.</li>
<li>You can see a row per sheet.</li>
<li>Each argument has become a column.</li>
<li>The list of dataframes has become a list-column.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-row" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">A row</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb17-1" class="hljs-ln-code"><a href="#cb17-1"></a><span class="fu">str</span>(egg_at[egg_at<span class="sc">$</span>tab_title <span class="sc">==</span> <span class="st">"Table_2"</span>, ] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'a11ytable', 'tbl' and 'data.frame':    1 obs. of  6 variables:
 $ tab_title  : chr "Table_2"
 $ sheet_type : chr "tables"
 $ sheet_title: chr "Table 2: Throughput by system, quarterly"
 $ blank_cells: chr NA
 $ source     : chr "Quarterly UK Egg Packing Station Survey."
 $ table      :List of 1
  ..$ qtrly_system: tibble [424 × 4] (S3: tbl_df/tbl/data.frame)
  .. ..$ Year                : chr  "1996" "1996" "1996" "1996" ...
  .. ..$ Quarter             : chr  "Q1" "Q1" "Q1" "Q1" ...
  .. ..$ System [note 1]     : chr  "Enriched" "Barn" "Free Range" "Organic" ...
  .. ..$ Eggs (million dozen): chr  "151" "3.2" "16.6" "[z]" ...</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>Each row of the a11ytable is the content required to create a worksheet.</li>
<li>Here’s the information needed for the sheet that contains Table 2.</li>
<li>You can see the character vectors contain the information needed in that sheet, along with the dataframe that contains the stat table itself.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="workbook" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Workbook</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb19-1" class="hljs-ln-code"><a href="#cb19-1"></a>egg_wb <span class="ot">&lt;-</span> <span class="fu">generate_workbook</span>(egg_at)</span>
<span id="cb19-2" class="hljs-ln-code"><a href="#cb19-2"></a><span class="fu">class</span>(egg_wb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Workbook"
attr(,"package")
[1] "openxlsx"</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>Next step is to turn the a11ytable-class object into an {openxlsx} Workbook-class object.</li>
<li>This adds all the required structure and style information without the user needing to do anything.</li>
<li>Works with a series of underlying <code>add_*()</code> functions to add elements to each sheet and <code>style_*()</code> functions that do simple stuff like adjust the font, but also dynamically change column widths and detect numeric columns that are stored as character due to notes or shorthand.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="workbook-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Workbook</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb21-1" class="hljs-ln-code"><a href="#cb21-1"></a>egg_wb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A Workbook object.
 
Worksheets:
 Sheet 1: "Cover"
 
    Custom row heights (row: height)
     2: 34, 4: 34, 6: 34, 8: 34, 10: 34, 12: 34 
    Custom column widths (column: width)
      1: 72 
 

 Sheet 2: "Contents"
 
    Custom column widths (column: width)
      1: 16, 2: 56 
 

 Sheet 3: "Notes"
 
    Custom column widths (column: width)
      1: 16, 2: 56 
 

 Sheet 4: "Table_1"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 16, 4: 16 
 

 Sheet 5: "Table_2"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 16, 4: 16 
 

 Sheet 6: "Table_3"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 16, 4: 16 
 

 Sheet 7: "Table_4"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 32 
 

 Sheet 8: "Table_5"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 32 
 

 Sheet 9: "Table_6"
 
    Custom column widths (column: width)
      1: 16, 2: 16, 3: 32 
 

 
 Worksheet write order: 1, 2, 3, 4, 5, 6, 7, 8, 9
 Active Sheet 1: "Cover" 
    Position: 1</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>Doesn’t really matter what the Workbook-class object looks like, but the summary shows the worksheets that have been created and some of the custom changes, like row heights.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="write" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Write</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb23-1" class="hljs-ln-code"><a href="#cb23-1"></a>openxlsx<span class="sc">::</span><span class="fu">saveWorkbook</span>(</span>
<span id="cb23-2" class="hljs-ln-code"><a href="#cb23-2"></a>  egg_wb,</span>
<span id="cb23-3" class="hljs-ln-code"><a href="#cb23-3"></a>  <span class="st">"eggs/2022-07-28_eggs-packers_test.xlsx"</span>,</span>
<span id="cb23-4" class="hljs-ln-code"><a href="#cb23-4"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb23-5" class="hljs-ln-code"><a href="#cb23-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li>{openxlsx} already has a function to write a Workbook-class object to disk.</li>
<li>This saves us hassle.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="write-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Write</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb24-1" class="hljs-ln-code"><a href="#cb24-1"></a>openxlsx<span class="sc">::</span><span class="fu">saveWorkbook</span>(</span>
<span id="cb24-2" class="hljs-ln-code"><a href="#cb24-2"></a>  egg_wb,</span>
<span id="cb24-3" class="hljs-ln-code"><a href="#cb24-3"></a>  <span class="st">"eggs/2022-07-28_eggs-packers_test.xlsx"</span>,</span>
<span id="cb24-4" class="hljs-ln-code"><a href="#cb24-4"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb24-5" class="hljs-ln-code"><a href="#cb24-5"></a>)</span>
<span id="cb24-6" class="hljs-ln-code"><a href="#cb24-6"></a></span>
<span id="cb24-7" class="hljs-ln-code"><a href="#cb24-7"></a><span class="fu">list.files</span>(<span class="st">"eggs"</span>, <span class="at">pattern =</span> <span class="st">".xlsx$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-07-28_eggs-packers_test.xlsx"</code></pre>
</div>
</div>
<aside class="notes">
<ul>
<li>The file has been provably created at the location specified.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="output" class="title-slide slide level1 center">
<h1>Output</h1>

</section>
<section id="section-10" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-cover.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" style="top: 40%; left: 35%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Most of this information was in the ‘information’ tab or footnotes of the original spreadsheet.</li>
<li>Now it’s up front and provides an introduction to the workbook.</li>
<li>Note on the cover that:
<ul>
<li>the font is Arial 12</li>
<li>the title is in larger font and in A1</li>
<li>the font subsection headers are also adjusted</li>
<li>the subsection titles are in tall rows to create the illusion of whitespace without leaving an empty row</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-11" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-contents.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" style="top: 2%; left: 25%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Note in the contents that:
<ul>
<li>there is up-front screenreader-friendly information about the number of tables in the sheet</li>
<li>the table has no empty rows or columns</li>
<li>the columns have clear header names indicated by bold font</li>
<li>the table is marked up as a table (there’s a small marker in the lower right to indicate this), which is important</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-12" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-notes.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" style="top: 20%; left: 35%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>On the notes page, note that:
<ul>
<li>the theming follows on from the cover and contents</li>
<li>the notes are in the standardised style of ‘note x’ written in square brackets</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-13" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-t1.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" style="top: 3%; left: 35%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Note in Table 1 that:
<ul>
<li>the theming again follows on from the other sheets</li>
<li>there is a new metadata element that provides the data source</li>
<li>the table has been dynamically placed in row 4 this time, after the three pre-table elements (was only two for the contents and notes pages)</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-14" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-t2.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" data-top="20" data-left="400" style="top: 5%; left: 35%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Note in Table 2 that:
<ul>
<li>this table has a note in it, so there’s a new dynamically generated pre-table metadata row so users of screenreaders can be made aware early</li>
<li>the placement of the table is again dynamic; there are four pre-table metadata elements, so the table begins in row 5</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-15" class="slide level2" data-auto-animate="true" data-auto-animate-easing="ease-in-out" data-background-image="images/spreadsheet_new-eggs-t5.png">
<h2 data-id="quarto-animate-title"></h2>
<p><img data-src="images/not-clippy-heart.png" class="absolute" style="top: 30%; left: 15%; width: 100px; "></p>
<aside class="notes">
<ul>
<li>Table 5 has something different again, which is that the long header has led to an opinionated decision for the column to be widened</li>
<li>An extra pre-table metadata row would also appear if we had provided information to the <code>blank_cells</code> argument of <code>create_a11ytable()</code></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="but" class="title-slide slide level1 center">
<h1>But</h1>

</section>
<section id="not-perfect" class="slide level2 center">
<h2>Not perfect</h2>
<ul>
<li>User-input</li>
<li>Opinionated</li>
<li>User-testing</li>
</ul>
<aside class="notes">
<ul>
<li>The package doesn’t get you a 100% compliant output.</li>
<li>Can’t guarantee bad user input.</li>
<li>To keep the package simple, certain choices may not suit the user; some extra editing of the a11ytable or Workbook may be required, but this can be made part of the analyst pipeline.</li>
<li>The package is opinionated for simplicity and is not completely flexible as a result (e.g.&nbsp;each cover subsection has only a single body row, the pre-table metadata is only table count, note presence, blank-cell meaning and data source).</li>
<li>The package is not yet fully user tested.</li>
<li>Leave an issue or pull request.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="clunk" class="slide level2 center">
<h2>Clunk</h2>
<ul>
<li>Not ods</li>
<li>{openxlsx} has limitations</li>
<li>Notes</li>
</ul>
<aside class="notes">
<ul>
<li>In particular, published spreadsheets should be in an open format, but {openxlsx} nor other packages write Workbook-class objects to ODS.</li>
<li>{openxlsx} is versatile, but some things are tricky (placeholder zeroes in decimals, filling in file properties, etc), but I’m keeping an eye on {openxlsx2}.</li>
<li>A more focused example: notes are pretty clunky to add; might be a better solution?</li>
<li>Leave an issue or pull request.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="future" class="slide level2 center">
<h2>Future</h2>
<ul>
<li>Bugfixes, requests</li>
<li>Mirror gptables output?</li>
<li>YAML input?</li>
</ul>
<aside class="notes">
<ul>
<li>There’s plenty to be done to improve the package.</li>
<li>As ever, user feedback and bugs.</li>
<li>gptables and a11ytables should converge as much as possible so that analyst users can expect the same compliant output despite which tool they use. What are the optimum opinionated features?</li>
<li>The problem is I have no time!</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="if-all-else-fails" class="title-slide slide level1 center">
<h1>If all else fails</h1>
<aside class="notes">
<ul>
<li>The idea is to fix the problem at the source..</li>
<li>But this won’t be possible for older spreadsheets and for pipelines that have inertia.</li>
<li>What can you do?</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-16" class="slide level2" data-background-image="images/website_smungs.png">
<h2></h2>
<aside class="notes">
<ul>
<li><a href="https://nacnudus.github.io/spreadsheet-munging-strategies/">Spreadsheet Munging Strategies</a> by another colleague, <a href="https://nacnudus.github.io/duncangarmonsway/">Duncan Garmonsway</a>.</li>
<li>Untidy, inaccessible spreadsheets pose a particular problem for further analysis.</li>
<li>See Duncan’s <a href="https://nacnudus.github.io/tidyxl/index.html">{tidyxl}</a> and <a href="https://nacnudus.github.io/unpivotr/">{unpivotr}</a> R packages.</li>
<li>I want to help limit the need for these tools (sorry Duncan).</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="consider" class="slide level2">
<h2>Consider</h2>
<ol type="1">
<li>How could you improve user experience?</li>
<li>Do you have the right processes in place?</li>
<li>Could you create tools to remove friction?</li>
</ol>
</section>
<section id="tldr-1" class="slide level2 center">
<h2>tl;dr</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p>Generate best-practice spreadsheets with <a href="https://www.co-analysis.github.io/a11ytables">{a11ytables}</a></p>
<p>Make the world a better place (marginally)</p>
</div><div class="column" style="width:30%;">
<p><img data-src="images/qr_a11ytables-docs.png" alt="QR code that points to the documentation website of the R package 'a11ytables'."></p>
</div>
</div>
<div class="footer footer-default">
<p>WORK IN PROGRESS</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

       // Parallax background image
       parallaxBackgroundImage: 'images/bg_cells.png', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>